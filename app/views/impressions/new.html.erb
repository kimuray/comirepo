<% content_for :load_vuejs do %>
  <%= javascript_pack_tag 'impression_vue' %>
<% end %>

<%= render 'eye_catch' %>

<div id="js-impression-new" class="post-form">
  <div class="post-form-modal" v-if="isModal">
    <div class="siimple-spinner siimple-spinner--blue"></div>
  </div>
  <share-menu-modal
    :post-data="postData"
    @close-menu="closeShareMenu"
    v-if="isDisplayShareMenu">
  </share-menu-modal>
  <div class="post-form-container">
    <%= form_with model: @impression, url: api_impressions_path, local: true, html: { '@submit.prevent' => 'onSubmit' } do |form| %>
      <suggest-title-text-form
        :errors="errors.comicTitle"
        @change-title="changeTitle">
      </suggest-title-text-form>
      <br>

      <div class="siimple-form-field mb-30">
        <div class="siimple-form-field-label post-form-label">
          <%= image_tag asset_pack_path('images/obake_icon.png'), class: 'post-form-character' %>
          <span class="post-form-balloon">読んだ単行本を巻数を教えてね！</span>
        </div>
        <input
          type="number"
          v-model="formData.volumeNumber"
          name="impression[volume_number]"
          class="siimple-input post-form-fluid"
          placeholder="単行本の巻数を入力してね！" />
      </div>

      <div class="siimple-form-field mb-30">
        <div class="siimple-form-field-label post-form-label">
          <%= image_tag asset_pack_path('images/obake_icon.png'), class: 'post-form-character' %>
          <span class="post-form-balloon">おすすめ度はどのくらい？</span>
        </div>
        <div class="post-form-emotions">
          <div class="post-form-emotions-field">
            <star-rating
              :increment="0.5"
              :star-size="35"
              v-model="formData.evaluationPoint" />
          </div>
        </div>
      </div>
      <br>
      <div class="siimple-form-field mb-30">
        <div class="siimple-form-field-label post-form-label">
          <%= image_tag asset_pack_path('images/obake_icon.png'), class: 'post-form-character' %>
          <span class="post-form-balloon">読んだ後の気持ちは？</span>
        </div>
        <div class="post-form-emotions">
          <% Emotion.order(:id).each do |emotion| %>
            <div class="post-form-emotions-item">
              <div class="siimple-checkbox">
                <input
                  id="emotion<%= emotion.id %>"
                  type="checkbox"
                  v-model="formData.emotions"
                  value="<%= emotion.id %>" />
                <label for="emotion<%= emotion.id %>"></label>
              </div>
              <label class="siimple-label"><%= emotion.name %></label>
            </div>
          <% end %>
        </div>
      </div>
      <br>
      <div class="siimple-form-field mb-30">
        <div class="siimple-form-field-label post-form-label">
          <%= image_tag asset_pack_path('images/obake_icon.png'), class: 'post-form-character' %>
          <span class="post-form-balloon">感想をおしえて！</span>
        </div>
        <textarea
          v-model="formData.report"
          name="impression[report]"
          class="siimple-textarea post-form-fluid"
          rows="10"
          placeholder="感想を入力してね！"
          required></textarea>
        <p v-if="errors.report.hasError">{{ errors.report.message }}</p>
      </div>

      <div class="siimple-form-field">
        <input type="submit" value="Tweet" data-disable-with="Tweet" class="siimple-btn siimple-btn--blue post-form-button">
      </div>
    <% end %>

    <div id="js-capture-area" class="capture">
      <capture-area :comic-title="formData.comicTitle"
                    :volume-number="formData.volumeNumber"
                    :evaluation-point="formData.evaluationPoint"
                    :report="formData.report"
                    :emotions="formData.emotions"></capture-area>
    </div>
  </div>
</div>


<img src="" id="test-image" />
